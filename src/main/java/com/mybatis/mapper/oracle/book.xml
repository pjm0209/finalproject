<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team2.mbti.book.model.BookDAO">
	
	<select id="selectBookAll" parameterType="bookVo" resultType="bookVo" >
		SELECT *
		FROM
		(
		    select rownum as RNUM, A.* from
		    (
			   select * from book
			   order by book_no 
		    )A
		)
		<![CDATA[
		WHERE RNUM > #{firstRecordIndex}
		and RNUM <= #{firstRecordIndex} + #{recordCountPerPage}]]>
	</select>
	
	<select id="selectBookCnt" resultType="int">
		SELECT count(*)FROM book
	</select>
	<sql id="searchWhere">
		<where>
			<if test="bookCategory!=null and bookCategory!=''">
				book_category like '%' || #{bookCategory} || '%'
			</if>
			<if test="bookNo!=0">
				book_no like '%' || #{bookNo} || '%'
			</if>
			<if test="bookTitle!=null and bookTitle!=''">
				book_title like '%' || #{bookTitle} || '%'
			</if>
			<if test="bookPublisher!=null and bookPublisher!=''">
				book_publisher like '%' || #{bookPublisher} || '%'
			</if>
			<if test="bookUseflag!=null and bookUseflag!=''">
				book_useflag like '%' || #{bookUseflag} || '%'
			</if>
			<if test="bookRegdate!=null and bookRegdate!=''">
				book_regdate like '%' || #{bookRegdate} || '%'
			</if>
		</where>
		<if test="orderBy!=null and orderBy!=''">
			order by #{orderBy}
		</if>
		<if test="orderBy==null and orderBy==''">
			order by book_no
		</if>
	</sql>
	<select id="selectByConditions" parameterType="bookVo">
		select * from book
		<include refid="searchWhere" />
	</select>
</mapper>